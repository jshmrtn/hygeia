<Form
  for={@changeset}
  change="validate"
  submit="save"
  opts={autocomplete: "off", id: "transmission-form", class: "view-test-show container"}
>
  <Context get={HygeiaWeb, auth: auth}>
    <h1 class="mb-3">
      {gettext("Test")}
      <!-- TODO: test data -->
    </h1>

    <div class="mt-4">
      <LivePatch
        :if={authorized?(@test, :update, auth)}
        to={Routes.test_show_path(@socket, :edit, @test.case, @test)}
      >
        <button class="btn btn-primary mb-3" id="test-edit">
          <span class="oi oi-pencil" title={gettext("Edit")} aria-hidden="true" />
          {gettext("Edit")}
        </button>
      </LivePatch>
      <Link
        to="#"
        click="delete"
        opts={
          title: gettext("Delete"),
          data: [confirm: gettext("Are you sure?")]
        }
        :if={authorized?(@test, :delete, auth)}
      >
        <button class="btn btn-danger mb-3">
          <span class="oi oi-trash" aria-hidden="true" />
          {gettext("Delete")}
        </button>
      </Link>
    </div>

    <HygeiaWeb.Lock
      id={"lock_Test_#{@test.uuid}"}
      resource={{Test, @test.uuid}}
      lock={@live_action == :edit}
    >
      <HygeiaWeb.CaseLive.TestsForm disabled={@live_action == :show} id="test-show" />
    </HygeiaWeb.Lock>

    <button
      class="btn btn-primary"
      type="submit"
      phx-disable-with={gettext("Saving...")}
      disabled={not @changeset.valid?}
    >
      {gettext("Save")}
    </button>
  </Context>
</Form>
